[<- К содержанию](readme.md)

### 3.5 Простейшее перебазирование

Когда у нас есть 2 ветки:

![История коммитов простого разделения](basic-rebase-1.png)

простейший способ выполнить слияние двух веток — это команда `merge`. Она осуществляет трёхстороннее слияние между двумя последними снимками сливаемых веток (C3 и C4) и самого недавнего общего для этих веток родительского снимка (C2), создавая новый снимок (и коммит).

![Слияние разделённой истории коммитов](basic-rebase-2.png)

Тем не менее есть и другой способ: вы можете взять те изменения, что были представлены в C4, и применить их поверх C3. В Git это называется перебазированием. С помощью команды `rebase` вы можете взять все коммиты из одной ветки и в том же порядке применить их к другой ветке.

В данном примере переключимся на ветку `experiment` и перебазируем её относительно ветки `master` следующим образом:

```
$ git checkout experiment
$ git rebase master
First, rewinding head to replay your work on top of it...
Applying: added staged command
```

Это работает следующим образом: берётся общий родительский снимок двух веток (текущей, и той, поверх которой вы выполняете перебазирование), определяется дельта каждого коммита текущей ветки и сохраняется во временный файл, текущая ветка устанавливается на последний коммит ветки, поверх которой вы выполняете перебазирование, а затем по очереди применяются дельты из временных файлов.

![Перебазирование изменений из C4 поверх C3](basic-rebase-3.png)

После этого вы можете переключиться обратно на ветку master и выполнить слияние перемоткой.

```
$ git checkout master
$ git merge experiment
```

![Перемотка ветки master](basic-rebase-4.png)

Теперь снимок, на который указывает C4' абсолютно такой же, как тот, на который указывал C5 в примере с трёхсторонним слиянием. Нет абсолютно никакой разницы в конечном результате между двумя показанными примерами, но перебазирование делает историю коммитов чище. Если вы взглянете на историю перебазированной ветки, то увидите, что она выглядит абсолютно линейной: будто все операции были выполнены последовательно, даже если изначально они совершались параллельно.

Так можно делать для уверенности, что коммиты могут быть бесконфликтно слиты в удалённую ветку. Можно работать в своей ветке и затем перебазировать работу поверх `origin/master`. Тогда владельцу проекта не придётся делать никакой лишней работы — всё решится простой перемоткой или бесконфликтным слиянием.

[<- Назад](branching-workflows.md)