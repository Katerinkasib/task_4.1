[<- К содержанию](readme.md)

### Работа с тегами

В GIT как правило теги используются для пометки версий (v1.0, и т. п.).

#### Просмотр списка тегов

`git tag` перечислит теги в алфавитном порядке.

`git tag -l "версия"` или `git tag --list "версия"` выполнит поиск тега по шаблону. 

Например `git tag -l "v1.8.5*"`

#### Создание легковесных тегов

Легковесный тег — это что-то очень похожее на ветку, которая не изменяется — просто указатель на определённый коммит.

`git tag <тег>` 

опции `-a` `-m` `-c` указывать не нужно.

#### Создание аннотированных тегов

Аннотированные теги хранятся в базе данных Git как полноценные объекты. Они имеют контрольную сумму, содержат имя автора, его e-mail и дату создания, имеют комментарий и могут быть подписаны и проверены с помощью GNU Privacy Guard (GPG). Обычно рекомендуется создавать аннотированные теги, чтобы иметь всю перечисленную информацию; но если вы хотите сделать временную метку или по какой-то причине не хотите сохранять остальную информацию, то для этого годятся и легковесные.

`git tag -a <тег> -m "описание тега"` создаст аннотированный тег.

`git show` покажет данные тега вместе с коммитом.

#### Отложенная расстановка тегов

Для отметки коммита укажем его контрольную сумму (или её часть) как параметр команды
`git tag -a <тег><контрольная сумма>`

#### Обмен тегами

По умолчанию, команда `git push` не отправляет теги на удалённые сервера, их надо отправлять отдельно.

`git push origin <тег>` отправит тег в удаленный репозиторий с псевдонимом `origin`

`git push origin --tags` отправит сразу все теги в удаленный репозиторий с псевдонимом `origin`.

`git push origin --follof-tags` отправит только аннотированные теги в удаленный репозиторий с псевдонимом `origin`.

Если кто-то клонирует или сделает `git pull`, то он сможет получить репозиторий уже с метками.

#### Удаление тегов

`git tag <тег>` удалит тег из локального репозитория.

`git push origin :refs/tags/<тег>` удалит тег из удаленного репозитория c псевдонимом `origin`. Это следует понимать как обновление внешнего тега пустым значением, что приводит к его удалению.

`git push origin --delete <тег>` тоже удалит тег из удаленного репозитория c псевдонимом `origin`

#### Как получить версии файлов, на которые указывает тег

Если вы хотите получить версии файлов, на которые указывает тег, то вы можете сделать `git checkout` для тега. Однако, это переведёт репозиторий в состояние «detached HEAD», которое имеет ряд неприятных побочных эффектов.
```
$ git checkout v2.0.0
Note: switching to 'v2.0.0'.

You are in 'detached HEAD' state. You can look around, make experimental
changes and commit them, and you can discard any commits you make in this
state without impacting any branches by performing another checkout.

If you want to create a new branch to retain commits you create, you may
do so (now or later) by using -c with the switch command. Example:

  git switch -c <new-branch-name>

Or undo this operation with:

  git switch -

Turn off this advice by setting config variable advice.detachedHead to false

HEAD is now at 99ada87... Merge pull request #89 from schacon/appendix-final

$ git checkout v2.0-beta-0.1
Previous HEAD position was 99ada87... Merge pull request #89 from schacon/appendix-final
HEAD is now at df3f601... Add atlas.json and cover image
```
Если в состоянии «detached HEAD» внести изменения и сделать коммит, то тег не изменится, при этом новый коммит не будет относиться ни к какой из веток, а доступ к нему можно будет получить только по его хешу. Поэтому, если вам нужно внести изменения — исправить ошибку в одной из старых версий — скорее всего вам следует создать ветку:
```
$ git checkout -b version2 v2.0.0
Switched to a new branch 'version2'
```
Если сделать коммит в ветке version2, то она сдвинется вперед и будет отличаться от тега `v2.0.0`, так что будьте с этим осторожны.

[<- Назад](working-with-remotes.md)

[Вперед ->](aliases.md)